<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Passer une Commande - Zghal Climatisation</title>
    <meta name="description" content="Finalisez votre commande de mat√©riel de climatisation ou de chauffage.">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <nav class="nav container">
            <a href="/" class="nav__logo">
                <img src="/logo.png" alt="Zghal Climatisation Logo" style="height: 40px;">
            </a>
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list">
                    <li class="nav__item"><a href="/" class="nav__link">Accueil</a></li>
                    <li class="nav__item"><a href="/#services" class="nav__link">Services</a></li>
                    <li class="nav__item"><a href="/vente.html" class="nav__link">Vente</a></li>
                    <li class="nav__item"><a href="/contact.html" class="nav__link">Contact</a></li>
                </ul>
                <div class="nav__close" id="nav-close">
                    <i class='bx bx-x'></i>
                </div>
            </div>
            <div class="header__contact">
                <span class="header__phone">üìû 44 882 490</span>
                <a href="/contact.html" class="button button--small">Devis Gratuit</a>
            </div>
            <div class="nav__toggle" id="nav-toggle">
                <i class='bx bx-menu'></i>
            </div>
        </nav>
    </header>

    <main>
        <section class="section container">
            <h1 class="section__title">Finaliser votre Commande</h1>
            <p class="section__subtitle">Veuillez remplir vos informations pour confirmer la commande.</p>

            <div class="contact__container">
                <form id="order-form" class="contact__form">
                    <div class="form__group">
                        <label for="product-name" class="form__label">Produit S√©lectionn√©</label>
                        <input type="text" id="product-name" name="produit" class="form__input" readonly required>
                    </div>
                    <div class="form__group">
                        <label for="name" class="form__label">Nom Complet</label>
                        <input type="text" id="name" name="name" class="form__input" required>
                    </div>
                    <div class="form__group">
                        <label for="phone" class="form__label">Num√©ro de T√©l√©phone</label>
                        <input type="tel" id="phone" name="phone" class="form__input" required>
                    </div>
                    <div class="form__group">
                        <label class="form__label">Option de livraison</label>
                        <div class="radio-group">
                            <input type="radio" id="livraison" name="livraison" value="Livraison √† domicile" checked>
                            <label for="livraison">Livraison √† domicile</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="retrait" name="livraison" value="Retrait sur place">
                            <label for="retrait">Retrait sur place</label>
                        </div>
                    </div>
                    <div class="form__group" id="adresse-group">
                        <label for="adresse" class="form__label">Adresse de livraison</label>
                        <input type="text" id="adresse" name="adresse" class="form__input" required>
                    </div>
                    <button type="submit" class="button button--flex">
                        Confirmer la Commande
                        <i class='bx bx-send button__icon'></i>
                    </button>
                </form>
                <div id="form-message"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer__container container">
            <div class="footer__socials">
                <a href="https://www.facebook.com/share/1ANse2h2HH/" target="_blank" class="footer__social-link"><i class='bx bxl-facebook-square'></i></a>
                <a href="https://www.instagram.com/zghal_climatisation?igsh=Z2UyN3M1cGs1cjdz" target="_blank" class="footer__social-link"><i class='bx bxl-instagram-alt'></i></a>
            </div>
            <p>&copy; 2025 Zghal Climatisation. Tous droits r√©serv√©s.</p>
            <p>Contact: zghalclimatisation@gmail.com | T√©l: 44 882 490 / 94 130 780</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', ( ) => {
            // --- R√©cup√©rer le nom du produit depuis l'URL ---
            const urlParams = new URLSearchParams(window.location.search);
            const produit = urlParams.get('produit');
            if (produit) {
                document.getElementById('product-name').value = produit;
            }

            // --- Logique du formulaire ---
            const form = document.getElementById('order-form');
            const formMessage = document.getElementById('form-message');
            const adresseGroup = document.getElementById('adresse-group');
            const livraisonRadio = document.getElementById('livraison');
            const retraitRadio = document.getElementById('retrait');
            const adresseInput = document.getElementById('adresse');

            livraisonRadio.addEventListener('change', () => {
                adresseGroup.style.display = 'block';
                adresseInput.required = true;
            });
            retraitRadio.addEventListener('change', () => {
                adresseGroup.style.display = 'none';
                adresseInput.required = false;
            });

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());

                formMessage.textContent = 'Envoi en cours...';
                formMessage.style.color = '#333';

                fetch('/send-commande', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (response.ok) {
                        form.reset();
                        formMessage.textContent = 'Merci! Votre commande a √©t√© envoy√©e. Nous vous contacterons pour la confirmation.';
                        formMessage.style.color = 'green';
                    } else {
                        throw new Error('Network response was not ok.');
                    }
                })
                .catch(error => {
                    formMessage.textContent = 'Une erreur est survenue. Veuillez r√©essayer.';
                    formMessage.style.color = 'red';
                });
            });
        });
    </script>
    <script src="/main.js"></script>
</body>
</html>
